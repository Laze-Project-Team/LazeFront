# クラス

クラスは自ら型を定義することができる機能で、普通の型とは違った機能を持たせることができます。まずはこちらのコードをご覧ください。

```
クラス:車 {
	整数:位置;
	整数:スピード;

	関数:車 (整数:初期位置, 整数:初期キー) => () {
		位置 = 初期位置;
		スピード = 0;
		キー = 初期キー;
	}

	関数:移動 () => () {
		位置 += スピード;
	}

	関数:アクセル (整数:強度) => () {
		スピード += 強度;
	}

	関数:ブレーキ (整数:強度) => () {
		スピード -= 強度;
	}

	関数:認証 (整数:認証キー) => (真偽:成功) {
		成功 = (認証キー == キー);
	}

	非公開:
		整数:キー;
}

車:セダン(0, 10294);

セダン.アクセル(10);
セダン.移動();
セダン.ブレーキ(5);

表示(セダン.位置);

// 表示(セダン.キー);
```

少し長いコードですが、どのような働きをしているのかを上から見ていきましょう。

## クラスの宣言

1行目で`クラス`というキーワードで"車"という名前のクラスを宣言しています。

2行目から変数や関数の宣言が行われていますが、これらを全てクラスの「メンバー」と呼びます。

## コンストラクタ

クラス名と同じ名前の関数をメンバーに宣言するとその関数は「コンストラクタ」という関数になります。コンストラクタとはクラスの利用時に最初に呼び出される関数のことです。ここでは31行目で"車"型の"セダン"という名前の変数を宣言していて、そこでコンストラクタを呼び出しています。この場合だと初期位置が`0`、初期キーが`10294`といった形です。また、このクラス型の変数のことを「オブジェクト」と呼びます。

## メンバーへのアクセス

オブジェクトのメンバーへのアクセスは`.`のようなピリオドでつなげて表します。例えば`車.位置`と書けば"車"というオブジェクトの"位置"というメンバーにアクセスしていることになります。また、変数など値を持つメンバーを「[プロパティ](#プロパティ)」、関数のメンバーを「[メソッド](#メソッド)」と呼びます。

また、`公開`、`非公開`のキーワードによってアクセスを制限することができます。`公開`はどこからでもアクセス可能、`非公開`はそのクラス内からのみアクセス可能になります。何もキーワードを付けなければ自動的に`公開`になります。これらの機能は安全性を高めるためのもので、慣れないうちは無理に使う必要はありません。

ここでは`キー`というプロパティが非公開になっています。そのためコメントアウトされている39行目のようにオブジェクト外からアクセスを試みるとエラーになってしまいます。

## プロパティ

クラスのメンバーの内、変数などの値を持つものをプロパティと呼びます。プロパティは

```
<変数名>.<プロパティ名>
```

でアクセスすることができ、オブジェクト内の値を参照することができます。ただしオブジェクト内から呼び出す場合は`<変数名>.`の部分は必要ありません。

移動、アクセル、ブレーキなどの関数でオブジェクトのプロパティを参照・変更しているのがわかるかと思います。

## メソッド

クラスのメンバーの内、コンストラクタ以外の関数をメソッドと呼びます。メソッドは

```
<変数名>.<メソッド名>( <引数> );
```

で呼び出すことができ、オブジェクトに対して様々な操作を行うことができます。ただしオブジェクト内から呼び出す場合は`<変数名>.`の部分は必要ありません。

33行目からの部分ではアクセルでスピードを上げてから移動を行って、ブレーキでスピードを落としています。その後の車の位置を表示させているので、ここでの位置は`10`であることがわかるかと思います。

## 継承

クラスは継承という機能を用いることによって型を拡張することができます。以下のコードをご覧ください。

```
クラス:車 {
	整数:位置;
	整数:スピード;

	関数:車 (整数:初期位置, 整数:初期キー) => () {
		位置 = 初期位置;
		スピード = 0;
		キー = 初期キー;
	}

	関数:認証 (整数:認証キー) => (真偽:成功) {
		成功 = (認証キー == キー);
	}

	非公開:
		整数:キー;
}

クラス:トラック <- 車 {
	整数:荷物;

	関数:トラック (実数:積み荷, 整数:初期キー) => () {
		位置 = 0;
		スピード = 3;
		荷物 = 積み荷;
		キー = 初期キー;
	}

	非公開:
		整数:キー;
}

関数:実行 () => () {
	トラック:日野(10, 10294);
	日野.位置=5;
	表示(日野.認証(10294));
}
```

21行目でクラスの継承が起きています。"車"というクラスを継承して"トラック"というクラスを宣言しています。継承することによって"車"が持つメンバーである"位置"、"スピード"、"キー"というプロパティと"認証"というメソッドが継承されます。"車"という関数は[コンストラクタ](#コンストラクタ)のため継承されません。